local enabled = true
local StarterGui = game:GetService("StarterGui")
local chatservice = game:GetService("TextChatService")
local textChannel = chatservice:WaitForChild("TextChannels"):WaitForChild("RBXGeneral")
local startbutton = script.Parent.StartButton
local stopbutton = script.Parent.StopButton
local addphrase = script.Parent.AddPhrase
local clearphrases = script.Parent.ClearPhrases
local phrasebox = script.Parent.PhraseBox
local resetphrases = script.Parent.ResetPhrases
local Playerservice = game:GetService("Players")
local phrases = {}
local roots = {}
local blacklisted = {
	9622393564
}
local localplr = Playerservice.LocalPlayer

local function resettable()
	phrases = {}
	for i,v in ipairs(getgenv().BotConfig.DefaultPhrases[1]) do
		table.insert(phrases,v)
	end
end

game.Players.PlayerAdded:Connect(function(plr)
	for i,v in pairs(blacklisted) do
		if plr.UserId == v then
			localplr:Kick("You cannot be in a server with this person")
		end
	end
end)

local function scanserver()
	while task.wait(0.1) do
		for i,v in pairs(Playerservice:GetPlayers()) do
			for i,userids in ipairs(blacklisted) do
				if v.UserId == userids then
					localplr:Kick("You cannot be in a server with this person")
				end
			end
		end
	end
end

task.spawn(scanserver)
task.spawn(resettable)

local function onandoff()
	startbutton.MouseButton1Up:Connect(function(clicked)
		enabled = true
		StarterGui:SetCore("SendNotification", {
			Title = "Script Enabled",
			Text = "Yay",
			Duration = 3,
		})
	end)
	stopbutton.MouseButton1Up:Connect(function(clicked)
		enabled = false
		StarterGui:SetCore("SendNotification", {
			Title = "Script Disabled",
			Text = "Ohnooo",
			Duration = 3,
		})
	end)
	addphrase.MouseButton1Up:Connect(function(addphrase)
		local text = phrasebox.Text
		table.insert(phrases,text)
		StarterGui:SetCore("SendNotification", {
			Title = "Phrases inserted",
			Text = "Inserted: ".. text,
			Duration = 3,
		})
	end)
	clearphrases.MouseButton1Up:Connect(function(clearedphrases)
		table.clear(phrases)
		StarterGui:SetCore("SendNotification", {
			Title = "Phrases Cleared",
			Text = "No phrases",
			Duration = 3,
		})
	end)
	resetphrases.MouseButton1Up:Connect(function()
		table.clear(phrases)
		task.spawn(resettable)
		StarterGui:SetCore("SendNotification", {
			Title = "Phrases Reset to default",
			Text = "Default as in the one specified when you executed this script",
			Duration = 3,
		})
	end)
end

task.spawn(onandoff)

local function spin()
	if localplr.Character then
		if localplr.Character:FindFirstChild("HumanoidRootPart") then
			local hrp = localplr.Character:FindFirstChild("HumanoidRootPart")
			if hrp:IsA("Part") then
				while hrp.Parent do
					task.wait()
					hrp.CFrame *= CFrame.Angles(0,0.1,0)
				end
			end
		end
	end
end

task.spawn(spin)

local function unsit()
	if localplr.Character then
		if localplr.Character:FindFirstChildWhichIsA("Humanoid") then
			local hum = localplr.Character:FindFirstChildWhichIsA("Humanoid")
			while task.wait(0.1) do
				if hum.Sit == true then
					hum.Sit = false
				end
			end
		end
	end
end

task.spawn(unsit)

localplr.CharacterAdded:Connect(function()
	task.spawn(spin)
end)

local function tablerefresh()
	table.clear(roots)
	for i,v in Playerservice:GetChildren() do
		if v:IsA("Player") then
			if v.Character then
				if v.Character:FindFirstChild("HumanoidRootPart") then
					if v.Character:FindFirstChild("HumanoidRootPart"):IsA("BasePart") then
						if v.Name ~= localplr.Name then
							local root = v.Character:FindFirstChild("HumanoidRootPart")
							table.insert(roots,root)
						end
					end
				end
			end
		end
	end
end

while task.wait(3) do
	if enabled == true then
		print("script is enabled")
		task.spawn(tablerefresh)
		if localplr.Character then
			if localplr.Character:FindFirstChild("HumanoidRootPart") then
				local hrp = localplr.Character:FindFirstChild("HumanoidRootPart")
				if hrp:IsA("Part") then
					if #roots > 0 then
						local randomhrp = roots[math.random(1,#roots)]
						hrp.CFrame = randomhrp.CFrame
						if #phrases > 0 then
							textChannel:SendAsync(phrases[math.random(1,#phrases)])
						else
							print("no phrases")
						end
					else
						print("no roots")
					end
				end
			end
		end
	else
		print("script is disabled")
	end
end
